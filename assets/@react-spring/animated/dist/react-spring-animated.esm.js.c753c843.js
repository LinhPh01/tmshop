import{e as V,d as H,h as S,g as $,a as h,i as o,b as j,c as O,u as k,f as B,j as D,r as w,k as K}from"../../shared/dist/react-spring-shared.esm.js.e4325886.js";import"../../../react/index.js.fa086085.js";import{r as F}from"../../rafz/dist/react-spring-rafz.esm.js.325c0a2b.js";import{r as c}from"../../../react/index.js_commonjs-module.8c7d3518.js";const f=Symbol.for("Animated:node"),L=e=>!!e&&e[f]===e,M=e=>e&&e[f],q=(e,t)=>H(e,f,t),z=e=>e&&e[f]&&e[f].getPayload();class U{constructor(){this.payload=void 0,q(this,this)}getPayload(){return this.payload||[]}}class p extends U{constructor(t){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=t,o.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new p(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,s){return o.num(t)&&(this.lastPosition=t,s&&(t=Math.round(t/s)*s,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,o.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}}class g extends p{constructor(t){super(0),this._string=null,this._toString=void 0,this._toString=O({output:[t,t]})}static create(t){return new g(t)}getValue(){let t=this._string;return t==null?this._string=this._toString(this._value):t}setValue(t){if(o.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=O({output:[this.getValue(),t]})),this._value=0,super.reset()}}const m={dependencies:null};class P extends U{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const s={};return V(this.source,(a,r)=>{L(a)?s[r]=a.getValue(t):S(a)?s[r]=$(a):t||(s[r]=a)}),s}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&h(this.payload,t=>t.reset())}_makePayload(t){if(t){const s=new Set;return V(t,this._addToPayload,s),Array.from(s)}}_addToPayload(t){m.dependencies&&S(t)&&m.dependencies.add(t);const s=z(t);s&&h(s,a=>this.add(a))}}class _ extends P{constructor(t){super(t)}static create(t){return new _(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const s=this.getPayload();return t.length==s.length?s.map((a,r)=>a.setValue(t[r])).some(Boolean):(super.setValue(t.map(G)),!0)}}function G(e){return(j(e)?g:p).create(e)}function tt(e){const t=M(e);return t?t.constructor:o.arr(e)?_:j(e)?g:p}function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},y.apply(this,arguments)}const T=(e,t)=>{const s=!o.fun(e)||e.prototype&&e.prototype.isReactComponent;return c.exports.forwardRef((a,r)=>{const l=c.exports.useRef(null),i=s&&c.exports.useCallback(n=>{l.current=W(r,n)},[r]),[d,A]=Q(a,t),E=k(),b=()=>{const n=l.current;if(s&&!n)return;(n?t.applyAnimatedValues(n,d.getValue(!0)):!1)===!1&&E()},v=new J(b,A),u=c.exports.useRef();B(()=>(u.current=v,h(A,n=>D(n,v)),()=>{u.current&&(h(u.current.deps,n=>w(n,u.current)),F.cancel(u.current.update))})),c.exports.useEffect(b,[]),K(()=>()=>{const n=u.current;h(n.deps,x=>w(x,n))});const I=t.getComponentProps(d.getValue());return c.exports.createElement(e,y({},I,{ref:i}))})};class J{constructor(t,s){this.update=t,this.deps=s}eventObserved(t){t.type=="change"&&F.write(this.update)}}function Q(e,t){const s=new Set;return m.dependencies=s,e.style&&(e=y({},e,{style:t.createAnimatedStyle(e.style)})),e=new P(e),m.dependencies=null,[e,s]}function W(e,t){return e&&(o.fun(e)?e(t):e.current=t),t}const N=Symbol.for("AnimatedComponent"),et=(e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:s=r=>new P(r),getComponentProps:a=r=>r}={})=>{const r={applyAnimatedValues:t,createAnimatedStyle:s,getComponentProps:a},l=i=>{const d=R(i)||"Anonymous";return o.str(i)?i=l[i]||(l[i]=T(i,r)):i=i[N]||(i[N]=T(i,r)),i.displayName=`Animated(${d})`,i};return V(e,(i,d)=>{o.arr(e)&&(d=R(i)),l[d]=l(i)}),{animated:l}},R=e=>o.str(e)?e:e&&o.str(e.displayName)?e.displayName:o.fun(e)&&e.name||null;export{p as A,M as a,z as b,g as c,et as d,P as e,tt as g,q as s};
